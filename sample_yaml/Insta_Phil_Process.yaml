name: Insta_Phil_Process
data_strategy:
    id: PandasStrategy
    data_location: data/
steps:
    - ReadCSV:
        params:
            location: "~/SampleMCData/Billionaire Philanthropy - Instagram.csv"
            columns:
                User Name1: str
                Account1: str
                Description1: str
                Image Text1: str
                URL1: str
                Likes1: int
                Comments1: int
        outputs: configured__
    
    - PrintFieldTask:
        params:
            pre_message: "Printing  User Name1"
        inputs:
            to_print: User Name1
    
    - LanguageDetectionTask:
        inputs:
            text: Image Text1
        outputs:
            language: language
            
    - APIEntityExtraction:
        inputs:
            text: Image Text1
            language: language
        outputs:
            entities: entities
        
        load_if_cached: True
            
    - PrintFieldTask:
        params:
            pre_message: "Printing Entities"
        inputs:
            to_print: entities
    
    - TopNEntities:
        params:
            top_n: 10
        inputs:
            entities: entities
        outputs:
            top_entities: top_10_entities
            
    - PrintFieldTask:
        params:
            pre_message: "Printing Top Entities"
        inputs:
            to_print: top_10_entities
            
    - SimpleTokenizeTask:
        inputs:
            text: Image Text1
        outputs:
            tokens: tokens
            
    - MostCommonTask:
        params:
            top_n: 20 
        inputs:
            to_count: tokens
        outputs:
            top_elements: top_tokens
            
    - PrintFieldTask:
        params:
            pre_message: "Printing Top Tokens"
        inputs:
            to_print: top_tokens
            
    - ExtractHashtags:
        inputs:
            text: Image Text1
        outputs: 
            matches: hashtags
    
    - MostCommonTask:
        params:
            top_n: 20
        inputs:
            to_count: hashtags
        outputs:
            top_elements: top_hashtags
    
    - PrintFieldTask:
        params:
            pre_message: "Printing Top Hashtags"
        inputs:
            to_print: top_hashtags
            
    - ExtractURLS:
        inputs:
            text: Image Text1
        outputs: 
            matches: urls
    
    - MostCommonTask:
        params:
            top_n: 10
        inputs:
            to_count: urls
        outputs:
            top_elements: top_urls
        
    - PrintFieldTask:
        params:
            pre_message: "Printing Top URLS"
        inputs:
            to_print: top_urls
    